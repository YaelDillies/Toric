\section{Introduction to Affine Toric Varieties}


\subsection{The Torus}


\begin{proposition}[The image of a torus is a torus]
  \label{1-1-1-group-hom-subtorus} % Proposition 1.1.1(a)
  \uses{0-torus}
  % \lean{}
  % \leanok

  Let $T_1$ and $T_2$ be split tori over a field $k$ and let $\phi: T_1 \to T_2$ be a homomorphism,
  then $\phi$ factors as
  \[
    T_1 \xrightarrow{\phi} T_2 = T_1 \xrightarrow{\iota} T \xrightarrow{\i} T_2,
  \]
  where $T$ is a split torus,
  $\i$ is a closed subgroup embedding and $\iota$ is an fpqc homomorphism.
\end{proposition}
\begin{proof}
  \uses{0-full-faithful-diag, 0-diag-spec, 0-diag-closed-emb, 0-diag-aff-hom}
  % \leanok

  By assumption, write $T_1 \cong D_k[G_1], T_2 \cong D_k[G_2]$.
  Call those isomorphisms $e_1, e_2$.
  By fullness of $D_k$ (Proposition \ref{0-full-faithful-diag}),
  find $f : G_2 \to G_1$ such that $D_k(f) = e_2 \circ \phi \circ e_1^{-1}$.
  Define $G$ to be the image of $f$ and take $T = D_k[G]$.
  Write $i : G \to G_1, p : G_2 \to G$ the inclusion and quotient maps respectively,
  so that $\phi = (e_2^{-1} \circ D_k(p)) \circ (D_k(i) \circ e_1)$.

  $G$ is a subgroup of a finitely-generated free abelian group $G_1$,
  hence itself a finitely-generated free abelian group
  (since free is equivalent to torsion-free for finitely-generated groups,
  and a subgroup of a torsion-free group is torsion-free).
  Thus $T$ is a split torus.

  $D_k(p)$ is a closed embedding by Proposition \ref{0-diag-closed-emb},
  and so is $e_2^{-1} \circ D_k(p)$.

  To show $D_k(i) \circ e_1$ is fpqc, it's enough to show that $D_k(i)$ is.
  $D_k(i)$ is affine by Proposition \ref{0-diag-aff-hom}, hence quasi-compact.
  It is faithfully flat by Proposition \ref{0-diag-faithful-flat}.
\end{proof}


\begin{proposition}[A subgroup of a torus is a torus]
  \label{1-1-1-subgroup-subtorus}
  \uses{0-torus}
  % \lean{}
  % \leanok

  Let $T$ be a split torus.
  If $H \subseteq T$ is an irreducible subgroup, then $H$ is a split torus.
\end{proposition}
\begin{proof}
  \uses{0-full-faithful-diag, 0-diag-spec}
  % \leanok

  Let $G = X(T), N=X(H)$. Since $H$ is a closed subscheme $M \to N$ is surjective,
  so $N$ is a finitely-generated abelian group. Since $H$ is irreducible it is connected,
  so $N$ is torsion-free, hence free. Thus $H$ is a split torus.
\end{proof}


\begin{definition}[The character eigenspace]
  \label{1-1-char-eigenspace}
  \uses{0-char}
  % \lean{}
  % \leanok

  For a finite dimensional representation of a torus $T$ on $W$, the {\bf character eigenspace} of a character $\chi \in X(T)$ is
  \[
    W_m = \{w\in W : t\cdot w = \chi(t)\text{ for all } t\in T \}.
  \]
\end{definition}


\begin{proposition}[Decomposition into character eigenspaces]
  \label{1-1-2-char-eigenspace-direct-sum}
  \uses{1-1-char-eigenspace}

  The space decomposes into the direct sum of the character eigenspaces.
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  TODO
\end{proof}


\subsection{The Definition of Affine Toric Variety}


\begin{definition}
  \label{1-1-3-tor-var}
  \uses{0-torus}
  \lean{AlgebraicGeometry.ToricVariety}
  \leanok
  Let $X$ be a scheme over $S$. A structure of {\bf toric variety} on $X$ over $S$ consists the following data
  \begin{itemize}
    \item a group scheme $T$ over $S$ that is a torus.
    \item a group action $T \times X \to X$ over $S$.
    \item an dominant open embedding $i : T \to X$ over $S$ that is $T$-equivariant.
  \end{itemize}
\end{definition}


\subsection{Lattice Points}


\begin{definition}
  \label{1-1-phiA}
  \uses{0-char}
  % \lean{}
  % \leanok

  Given a finite set $\MCA = \{a_1, \dotsc, a_s\} \subseteq M$, define $\Phi_\MCA : T \to \mathbb{A}^s$ given by $\Phi_{\mathcal A} (t) = (\chi^{a_1} (t), \dotsc, \chi^{a_s} (t))$.
\end{definition}


\begin{definition}
  \label{1-1-7-ya}
  \uses{1-1-phiA}
  % \lean{}
  % \leanok

  $Y_\MCA$ is the (Zariski) closure of $\im \Phi_\MCA$ in $\mathbb A^s$.
\end{definition}


\begin{proposition}
  \label{1-1-8-aff-tor-var-ya}
  \uses{1-1-7-ya}
  % \lean{}
  % \leanok

  $Y_\MCA$ is a toric variety.
\end{proposition}
\begin{proof}
  \uses{1-1-1-group-hom-subtorus}
  % \leanok

  TODO
\end{proof}

\begin{proposition}
  \label{1-1-8-char-ya}
  \uses{1-1-7-ya}
  % \lean{}
  % \leanok

  The character lattice of the torus of $Y_\MCA$ is $\Z \MCA$.
\end{proposition}
\begin{proof}
  \uses{0-char-torus}
  % \leanok

  $\Phi_\MCA: T_N \to \G_m^s$ factors through the torus of $Y_\MCA$.
  The conclusion follows from looking at the corresponding maps of character lattices.
\end{proof}

\subsection{Toric Ideals}


\begin{proposition}
  \label{1-1-9-ideal-ya}
  \uses{1-1-7-ya}
  % \lean{}
  % \leanok

  The ideal of the affine toric variety $Y_\MCA$ is
  \[
    I(Y_\MCA) = \langle x^{\ell_+} - x^{\ell_-} | \ell \in L\rangle
  \]
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}


\begin{definition}
  \label{1-1-10-lat-ideal}
  \uses{}
  \lean{AddMonoidAlgebra.monoidIdeal}
  \leanok

  The ideal $I_L = \langle x^\alpha - x^\beta | \alpha, \beta \in \N^s \text{ and } \alpha - \beta \in L\rangle$ is called the {\bf lattice ideal} of the lattice $L \subseteq \Z^s$.

  A toric ideal is a prime lattice ideal.
\end{definition}


\begin{definition}
  \label{1-1-10-toric-ideal}
  \uses{1-1-10-lat-ideal}
  \lean{AddMonoidAlgebra.IsToricIdeal}
  \leanok
  A {\bf toric ideal} is a prime lattice ideal.
\end{definition}


\begin{proposition}
  \label{1-1-11-toric-ideal-gen-binomial}
  \uses{1-1-10-toric-ideal}
  \lean{AddMonoidAlgebra.isToricIdeal_iff_exists_span_single_sub_single}
  % \leanok

  Proposition 1.1.11: an ideal is toric if and only if it's prime and generated by binomials $x^\alpha - x^\beta$.
\end{proposition}
\begin{proof}
  \uses{1-1-1-subgroup-subtorus, 1-1-9-ideal-ya}
  % \leanok

\end{proof}


\begin{proposition}[The spectrum of an affine monoid algebra is an affine toric variety]
  \label{1-1-14-aff-tor-var-spec-aff-mon-alg}
  \uses{0-aff-mon, 1-1-3-tor-var}
  \lean{AffineToricVarietyFromMonoid.instToricVariety}
  \leanok

  If $S$ is an affine monoid, then $\Spec \Bbbk[S]$ is an affine toric variety.
\end{proposition}
\begin{proof}
  \uses{0-aff-mon-alg-domain, 0-full-faithful-grp-alg, 0-diag-spec}
  % \leanok

  Identify the torus with $\Bbbk[x_1^{\pm1}, \dotsc, x_n^{\pm1}]$ using Lemma \ref{0-diag-spec}.
  $i$ induces a morphism $T \to \Spec \Bbbk[S]$. It's an open embedding as $i$ gives the localization of $\Bbbk[S]$ at $\chi^{a_i}$, so $\im i$ is an affine open. It's dominant as $\Spec \Bbbk[S]$ is integral and so is irreducible, and $\im i$ is open and nonempty, so dense. The torus action is given by the natural restriction of comultiplication on $\Bbbk[x_1^{\pm1}, \dotsc, x_n^{\pm1}]$ using Proposition \ref{0-full-faithful-grp-alg}.
\end{proof}


\begin{proposition}
  \label{1-1-14-spec-aff-mon-alg-eq-ya}
  \uses{0-aff-mon, 1-1-3-tor-var, 1-1-7-ya}
  % \lean{}
  % \leanok

  If $S$ is an affine monoid and $\mathcal A$ is a finite set generating $S$ as a monoid, then $\Spec \Bbbk[S] = Y_{\mathcal A}$.
\end{proposition}
\begin{proof}
  \uses{1-1-8-aff-tor-var-ya}
  % \leanok

  We get a $\Bbbk$-algebra homomorphism $\pi : \Bbbk[x_1, \dotsc, x_s] \to \Bbbk[\Z S]$ given by $\mathcal A$; this induces a morphism $\Phi_{\mathcal A} : T \to \Bbbk^s$. The kernel of $\pi$ is the toric ideal of $Y_{\mathcal A}$ and $\pi$ is clearly surjective, so $Y_{\mathcal A} = \mathbb V(\ker(\pi)) = \Spec \Bbbk[x_1, \dotsc, x_s] / \ker(\pi) = \Spec \bbC[S]$.
\end{proof}


\begin{proposition}[The character lattice of the spectrum of an affine monoid algebra]
  \label{1-1-14-char-spec-aff-mon-alg}
  \uses{1-1-14-aff-tor-var-spec-aff-mon-alg, 0-char}
  % \lean{}
  % \leanok

  If $S$ is an affine monoid, then the character lattice of the torus of $\Spec \Bbbk[S]$ is $\Z S$.
\end{proposition}
\begin{proof}
  \uses{1-1-14-spec-aff-mon-alg-eq-ya}
  % \leanok

  It is what it is.
\end{proof}


\subsection{Equivalence of Constructions}


\begin{definition}
  \label{1-1-tor-act-alg}
  \uses{0-torus}
  % \lean{}
  % \leanok

  There is a torus action on the semigroup algebra $\bbC[M]$: given $t\in T_N$ and $f\in \bbC[M]$ define
  \[
    t \cdot f = (p \mapsto f(t^{-1}p)).
  \]
\end{definition}


\begin{lemma}
  \label{1-1-16-total-red}
  \uses{1-1-tor-act-alg}
    Let $A \subseteq \bbC[M]$ be a stable subspace, then
    \[
      A = \bigoplus_{\chi^m \in A} \bbC \cdot \chi^m.
    \]
\end{lemma}
\begin{proof}
  \uses{1-1-2-char-eigenspace-direct-sum}
  % \leanok

  TODO
\end{proof}


\begin{theorem}
  \label{thm:1-1-17}
  \uses{0-aff-mon, 1-1-3-tor-var, 1-1-7-ya, 1-1-10-lat-ideal}
  TFAE:
  \begin{enumerate}
    \item $V$ is an affine toric variety.
    \item $V = Y_{\mathcal A}$ for some finite $\mathcal A$.
    \item $V$ is an affine variety defined by a toric ideal.
    \item $V = \Spec \Bbbk[S]$ for an affine monoid $S$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  \uses{1-1-tor-act-alg, 1-1-8-aff-tor-var-ya, 1-1-9-ideal-ya, 1-1-14-aff-tor-var-spec-aff-mon-alg, 1-1-16-total-red}
  % \leanok

  TODO
\end{proof}

\section{Convex geometry}

\subsection{Polyhedral cones}

We work with a two mutually dual finite-dimensional vector spaces \( N
\) and \( M \) over a linearly ordered field \( \Bbbk \). This means,
we have a bilinear pairing \( \langle \cdot, \cdot \rangle \colon N
\times M \to \Bbbk \) such that the induced maps \( M \to
\Hom(N,\Bbbk) \) and \( N \to \Hom(N,\Bbbk) \) are both bijective
(this is also known as a \emph{perfect pairing}). Since \( \Bbbk \) is
linearly ordered, we cann define the non-negative scalar \(\Bbbk_{\geq
0} = \{t \in \Bbbk \mid t \geq 0 \} \subseteq \Bbbk\). This is a
\emph{semifield}, i.e. a commutative semiring, in which every nonzero
element has a multiplicative inverse.

\begin{definition}
  \label{0-pointed-cone}
  \uses{}
  \lean{PointedCone}
  \leanok
  A {\bf pointed cone} \( \sigma \subseteq N \) is a \( \Bbbk_{\geq 0}
  \)-submodule of \( N \).
\end{definition}

\begin{definition}
  \label{0-cone-span}
  \uses{0-pointed-cone}
  \lean{PointedCone.span}
  \leanok
  For a set \( S \subseteq N \), the {\bf cone generated by \( S \)}
  is the pointed cone
  \[
      \Cone(S) := \Span_{\Bbbk_{\geq 0}}(S) \subseteq N.
  \]
\end{definition}

\begin{definition}
  \label{0-cone-finitely-generated}
  \uses{0-pointed-cone}
  \lean{Submodule.FG}
  \leanok
  A pointed cone \( \sigma \subseteq N \) is called {\bf finitely
  generated}, if \( \sigma = \Cone(S) \) for some finite set \( S
  \subseteq N \).
\end{definition}

\begin{definition}
  \label{0-cone-dual}
  \uses{0-pointed-cone}
  \lean{PointedCone.dual'}
  \leanok
  For a set \( S \subseteq M \), the {\bf dual cone of \( S \)} is
  the pointed cone
  \[
      S^\vee := \{x \in N \mid \forall y \in S, \langle x, y \rangle
      \geq 0 \} \subseteq N.
  \]
\end{definition}

\begin{definition}
  \label{0-polyhedral-cone}
  \uses{0-cone-dual}
  \lean{PointedCone.IsPolyhedral}
  \leanok
  A pointed cone \( \sigma \subseteq N \) is called {\bf polyhedral},
  if \( \sigma = S^\vee \) for some finite set \( S \subseteq M \).
\end{definition}

\begin{proposition}
  \label{0-dual-polyhedral}
  \uses{0-polyhedral-cone, 1-2-1-cone-finitely-generated}
  \lean{PointedCone.IsPolyhedral.dual_of_fg}
  \leanok
  If \( \sigma \subset N \) is finitely generated, then \( \sigma^\vee
  \subset M \) is polyhedral.
\end{proposition}
\begin{proof}
  \uses{}
  \leanok
  Let \( \sigma = \Cone(S) \) for \( S \subseteq N \). We need to show
  \( \Cone(S)^\vee = S^\vee \). The inclusion ``\( \subseteq \)'' is
  obvious, as \( S \subseteq \Cone(S) \). The opposite inclusion can
  be shown by induction on the general element of \( \Cone(S) \).
\end{proof}

\begin{proposition}[Double dual]
  \label{0-double-dual-polyhedral-cone}
  \uses{0-polyhedral-cone}
  \lean{PointedCone.IsPolyhedral.dual_dual_flip,
  PointedCone.IsPolyhedral.dual_flip_dual}
  \leanok
  If \( \sigma \subseteq N \) is polyhedral, then \( \sigma^{\vee\vee}
  = \sigma \).
\end{proposition}
\begin{proof}
  \uses{}
  \leanok
  For any set \( S \subseteq N \) it is trivial to show \(
  S^{\vee\vee\vee} = S^{\vee} \). The claim follows since \( \sigma =
  S^{\vee} \) for a finite set \( S \subseteq N \).
\end{proof}

\begin{proposition}
  \label{0-bot-polyhedral}
  \uses{0-polyhedral-cone}
  \lean{PointedCone.IsPolyhedral.bot}
  \leanok
  The zero-space \( \{0\} \subseteq N \) is a polyhedral cone.
\end{proposition}
\begin{proof}
  \uses{}
  \leanok
  If \( S \subseteq M \) is a finite \( \Bbbk \)-basis of \( M \),
  then \( \{0\} = (S \cup -S)^\vee \).
\end{proof}

\begin{proposition}[Fourier-Motkin elimination]
  \label{0-fourier-motzkin}
  \uses{0-polyhedral-cone}
  \lean{PointedCone.dual_auxGenSet}
  \leanok
  If \( \sigma \subseteq N \) is a polyhedral cone and \( w \in N \),
  then \( \sigma + \Cone(\{w\}) \) is polyhedral too.
\end{proposition}
\begin{proof}
  \leanok
  Write \( \sigma = S^{\vee} \) for a finite \( S \subseteq M \).
  Define
  \[
      T\ :=\ \{x \in S \mid 0 \leq \langle x, w \rangle \}\ \cup\ 
      \{y \langle x, w \rangle - x \langle y, w \rangle \mid x, y \in
      S, 0 \leq \langle x, w \rangle, \langle y, w \rangle < 0 \}\ 
      \subseteq\ M.
  \]
  Note that \( T \) is finite. We claim \( S^{\vee} + \Cone(\{w\}) =
  T^{\vee} \). Clearly \( T \subseteq \Cone(S) \), hence \( S^{\vee} =
  \Cone(S)^{\vee} \subseteq T^{\vee} \). Also clear is \( w \in
  T^{\vee} \), hence \( S^{\vee} + \Cone(\{w\}) \subset T^{\vee} \).
\end{proof}

\begin{proposition}
  \label{0-polyhedral-of-fg}
  \uses{PointedCone.IsPolyhedral.of_fg}
  \lean{}
  \leanok
  If \( \sigma \in N \) is finitely generated, then it is polyhedral.
\end{proposition}
\begin{proof}
  \uses{0-bot-polyhedral, 0-fourier-motzkin}
  \leanok
  Write \( \sigma = \Cone(S) \) and use induction on the size of \( S
  \): For \( S = \emptyset \), we use use~\ref{0-bot-polyhedral}
  and the induction step is~\ref{0-fourier-motzkin}.
\end{proof}

\begin{proposition}
  \label{0-double-dual-finite-set}
  \uses{}
  \lean{PointedCone.dual_dual_eq_span}
  \leanok
  For a finite set \( S \subseteq N \), we have \( S^{\vee\vee} =
  \Cone(S) \).
\end{proposition}
\begin{proof}
  \uses{0-polyhedral-of-fg, 1-2-1-double-dual-polyhedral-cone}
  \leanok
  The cone \( \sigma := \Cone(S) \) is finitely generated, hence
  polyhedral by~\ref{0-polyhedral-of-fg}. Furthermore, we have \(
  \sigma^{\vee\vee} = S^{\vee\vee} \). Now
  apply~\ref{0-double-dual-polyhedral-cone}.
\end{proof}

\begin{proposition}[Polyhedral = Finitely generated]
  \label{0-polyhedral-iff-fg}
  \uses{}
  \lean{PointedCone.IsPolyhedral_iff_fg}
  \leanok
  A pointed cone \( \sigma \subseteq N \) is finitely generated iff it is
  polyhedral.
\end{proposition}
\begin{proof}
  \uses{0-polyhedral-of-fg}
  \leanok
  The implication ``\( \Rightarrow \)'' is
  Proposition~\ref{0-polyhedral-of-fg}. For the converse, assume
  \( \sigma = S^{\vee} \) for some finite \( S \subseteq M \). Then \(
  \Cone(S) \) is finitely generated, hence polyhedral
  by~\ref{0-polyhedral-of-fg}. Thus we find a finite \( T
  \subseteq N \) with \( \Cone(S) = T^\vee \). We obtain
  \[
      \sigma = S^{\vee} = \Cone(S)^\vee = T^{\vee\vee} = \Cone(T),
  \]
  where the last equality is due
  to~\ref{0-double-dual-finite-set}. Thus \( \sigma \) is finitely
  generated.
\end{proof}

\begin{proposition}
  \label{0-dual-polyhedral-cone}
  \uses{0-polyhedral-cone}
  \lean{PointedCone.IsPolyhedral.dual}
  \leanok
  If \( \sigma \subseteq N \) is
  polyhedral, then \( \sigma^\vee \subseteq M \) is polyhedral too.
\end{proposition}
\begin{proof}
  \uses{0-dual-polyhedral, 0-polyhedral-iff-fg}
  \leanok
  \ref{0-dual-polyhedral} \( + \) \ref{0-polyhedral-iff-fg}.
\end{proof}


\subsection{Faces, edges and facets}



Given $m \ne 0$ in $M$, we get the hyperplane
$$H_m = \{u \in N | \langle m, u\rangle = 0\} \subseteq N$$
and the closed half-space
$$H_m^+ = \{u \in N | \langle m, u\rangle \ge 0\} \subseteq N.$$


\begin{definition}[Face of a cone]
  \label{1-2-5-face}
  \uses{}
  \lean{IsExposed}
  \leanok

  If $\sigma$ is a cone, then a subset of $\sigma$ is a {\bf face} iff it is the intersection of $\sigma$ with some halfspace. We write this $\tau \preceq \sigma$. If furthermore $\tau \ne \sigma$, we call $\tau$ a proper face and write $\tau \prec \sigma$.
\end{definition}


\begin{definition}[Edge of a cone]
  \label{1-2-5-edge}
  \uses{1-2-5-face}
  % \lean{}
  % \leanok

  A dimension 1 face of a cone is called an {\bf edge}.
\end{definition}


\begin{definition}[Facet of a cone]
  \label{1-2-5-facet}
  \uses{1-2-5-face}
  % \lean{}
  % \leanok

  A codimension 1 face of a cone is called a {\bf facet}.
\end{definition}


\begin{lemma}[Face of a polyhedral cone]
  \label{1-2-6-face-polyhedral-cone}
  \uses{0-polyhedral-cone, 1-2-5-face}
  % \lean{}
  % \leanok

  If $\sigma$ is a polyhedral cone, then every face of $\sigma$ is a polyhedral cone.
\end{lemma}


\begin{lemma}[Intersection of faces]
  \label{1-2-6-inter-faces}
  \uses{0-polyhedral-cone, 1-2-5-face}
  % \lean{}
  % \leanok

  If $\sigma$ is a polyhedral cone, then the intersection of two faces of $\sigma$ is a face of $\sigma$.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{lemma}[Face of a face]
  \label{1-2-6-face-face}
  \uses{0-polyhedral-cone, 1-2-5-face}
  % \lean{}
  % \leanok

  A face of a face of a polyhedral cone $\sigma$ is again a face of $\sigma$.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{lemma}
  \label{1-2-7-face-mem-of-add}
  \uses{0-polyhedral-cone, 1-2-5-face}
  % \lean{}
  % \leanok

  Let $\tau$ be a face of a polyhedral cone $\sigma$. If $v, w \in \sigma$ and $v + w \in \tau$, then $v, w \in \tau$.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[Dual cone of the intersection of halfspaces]
  \label{1-2-8-dual-cone-inter-halfspaces}
  \uses{1-2-cone-span, 0-dual-cone}
  % \lean{}
  % \leanok

  If $\sigma = H_{m_1}^+ \cap \dots \cap H_{m_s}^+$, then
  $$\sigma^\vee = \Cone(m_1, \dots, m_s).$$
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[Facets of a full dimensional cone]
  \label{1-2-8-facet-full-dim-cone}
  \uses{1-2-cone-span, 1-2-5-facet}
  % \lean{}
  % \leanok

  If $\sigma$ is a full dimensional cone, then facets of $\sigma$ are of the form $H_m \cap \sigma$.
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[Intersection of facets containing a face]
  \label{1-2-8-inter-facet}
  \uses{1-2-5-facet}
  % \lean{}
  % \leanok

  Every proper face $\tau \prec \sigma$ of a polyhedral cone $\sigma$ is the intersection of the facets of $\sigma$ containing $\tau$.
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{definition}[Dual face]
  \label{00-dual-face}
  \uses{0-dual-cone, 1-2-5-face}
  % \lean{}
  % \leanok

  Given a cone $\sigma$ and a face $\tau \preceq \sigma$, the {\bf dual face} to $\tau$ is
  $$\tau^* := \sigma^\vee \cap \tau^\perp$$
\end{definition}


\begin{proposition}[The dual face is a face of the dual]
  \label{00-dual-face-face-dual}
  \uses{00-dual-face}
  % \lean{}
  % \leanok

  If $\tau \preceq \sigma$, then $\tau^* \preceq \sigma^\vee$.
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[The double dual of a face]
  \label{00-double-dual-face-dual-face}
  \uses{00-dual-face}
  % \lean{}
  % \leanok

  If $\tau \preceq \sigma$, then $\tau^{**} = \tau$.
\end{proposition}
\begin{proof}
  \uses{1-2-4-double-dual-polyhedral-cone}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[The dual of a face is antitone]
  \label{00-dual-face-antitone}
  \uses{00-dual-face}
  % \lean{}
  % \leanok

  If $\tau' \preceq \tau \preceq \sigma$, then $\tau' \preceq \tau$.
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[The dimension of the dual of a face]
  \label{00-dim-dual-face}
  \uses{00-dual-face}
  % \lean{}
  % \leanok

  If $\tau \preceq \sigma$, then
  $$\dim \tau + \dim \tau^* = \dim N.$$
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\subsection{Relative Interiors}


\begin{definition}[Relative interior]
  \label{1-2-rel-interior}
  \uses{}
  \lean{intrinsicInterior}
  \leanok

  The {\bf relative interior}, aka {\bf intrinsic interior}, of a cone $\sigma$ is the interior of $\sigma$ as a subset of its span.
\end{definition}


\begin{lemma}[The relative interior in terms of the inner product]
  \label{1-2-rel-interior-inner}
  \uses{1-2-rel-interior}
  % \lean{}
  % \leanok

  For a cone $\sigma$,
  $$u \in \Relint(\sigma) \iff \forall m \in \sigma^\vee \setminus \sigma^\perp, \langle m, u\rangle > 0$$
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{lemma}[Relative interior of a dual face]
  \label{1-2-rel-interior-dual-face}
  \uses{00-dual-face, 1-2-rel-interior}
  % \lean{}
  % \leanok

  If $\tau \preceq \sigma$ and $m \in \sigma^\vee$, then
  $$m \in \Relint(\tau^*) \iff \tau = H_m \cap \sigma$$
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{lemma}[Minimal face of a cone]
  \label{1-2-min-face}
  \uses{1-2-5-face, 1-2-rel-interior}
  % \lean{}
  % \leanok

  If $\sigma$ is a cone, then $W := \sigma \cap (-\sigma)$ is a subspace. Furthermore,
  $W = H_m \cap \sigma$ whenever $m \in \Relint(\sigma^\vee)$.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\subsection{Strong Convexity}


\begin{definition}[Salient cones]
  \label{02-salient-cone}
  \uses{}
  \lean{ConvexCone.Salient}
  \leanok

  A cone $\sigma$ is {\bf salient}, aka {\bf pointed} or {\bf strongly convex}, if $\sigma \cap (-\sigma) = \{0\}$.
\end{definition}


\begin{proposition}[Alternative definitions of salient cones]
  \label{02-salient-cone-tfae}
  \uses{0-dual-cone, 02-salient-cone}
  % \lean{}
  % \leanok

  The following are equivalent
  \begin{enumerate}
    \item $\sigma$ is salient
    \item $\{0\} \preceq \sigma$
    \item $\sigma$ contains no positive dimensional subspace
    \item $\dim \sigma^\vee = \dim N$
  \end{enumerate}
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\subsection{Separation}


\begin{lemma}[Separation lemma]
  \label{03-separation-lemma}
  \uses{0-polyhedral-cone, 1-2-5-face}
  % \lean{}
  % \leanok

  Let $\sigma_1, \sigma_2$ be polyhedral cones meeting along a common face $\tau$. Then
  $$\tau = H_m \cap \sigma_1 = H_m \cap \sigma_2$$
  for any $m \in \Relint(\sigma_1^\vee \cap (-\sigma_2)^\vee)$.
\end{lemma}
\begin{proof}
  \uses{1-2-dual-cone-add, 1-2-min-face}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}


\subsection{Rational Polyhedral Cones}


Let $M$ and $N$ be dual lattices with associated vector spaces $M_\R := M \ox_\Z \R, N_\R := N \ox_\Z \R$.


\begin{definition}[Rational cone]
  \label{04-rat-cone}
  \uses{1-2-cone-span}
  % \lean{}
  % \leanok

  A cone $\sigma \subseteq N_\R$ is {\bf rational} if $\sigma = \Cone(S)$ for some finite set $S \subseteq N$.
\end{definition}


\begin{lemma}[Faces of a rational cone]
  \label{04-face-rat-cone}
  \uses{1-2-5-face, 04-rat-cone}
  % \lean{}
  % \leanok

  If $\tau \preceq \sigma$ is a face of a rational cone, then $\tau$ itself is rational.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{lemma}[The dual of a rational cone]
  \label{04-dual-rat-cone}
  \uses{0-dual-cone, 04-rat-cone}
  % \lean{}
  % \leanok

  $\sigma^\vee$ is a rational cone iff $\sigma$ is.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{definition}[Ray generator]
  \label{1-2-ray-gen}
  \uses{1-2-5-edge, 04-rat-cone}
  % \lean{}
  % \leanok

  If $\rho$ is an edge of a rational cone $\sigma$, then the monoid $\rho \cap N$ is generated by a unique element $u_\rho \in \rho \cap N$, which we call the {\bf ray generator} of $\rho$.
\end{definition}


\begin{definition}[Minimal generators]
  \label{1-2-min-gen}
  \uses{1-2-ray-gen}
  % \lean{}
  % \leanok

  The {\bf minimal generators} of a rational cone $\sigma$ are the ray generators of its edges.
\end{definition}


\begin{lemma}[A rational cone is generated by its minimal generators]
  \label{05-cone-hull-min-gen}
  \uses{02-salient-cone, 1-2-min-gen}
  % \lean{}
  % \leanok

  A salient convex rational polyhedral cone is generated by its minimal generators.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{definition}[Regular cone]
  \label{06-reg-cone}
  \uses{1-2-min-gen}
  % \lean{}
  % \leanok

  A salient rational polyhedral cone $\sigma$ is {\bf regular}, aka {\bf smooth}, if its minimal generators form part of a $\Z$-basis of $N$.
\end{definition}


\begin{definition}[Simplicial cone]
  \label{06-simplicial-cone}
  \uses{1-2-min-gen}
  % \lean{}
  % \leanok

  A salient rational polyhedral cone $\sigma$ is {\bf simplicial} if its minimal generators are $\R$-linearly independent.
\end{definition}


\subsection{Semigroup Algebras and Affine Toric Varieties}


\begin{definition}[Dual lattice of a cone]
  \label{07-dual-lat-cone}
  \uses{0-dual-cone}
  % \lean{}
  % \leanok

  If $\sigma \subseteq N_\R$ is a polyhedral cone, then the lattice points
  \[
    S_\sigma := \sigma^\vee \cap M
  \]
  form a monoid.
\end{definition}


\begin{proposition}[Gordan's lemma]
  \label{07-gordan-lemma}
  \uses{07-dual-lat-cone}
  % \lean{}
  % \leanok

  $S_\sigma$ is finitely generated as a monoid.
\end{proposition}
\begin{proof}
  \uses{04-dual-rat-cone}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}


\begin{definition}[Affine toric variety of a rational polyhedral cone]
  \label{08-aff-tor-var-rat-polyhedral-cone}
  \uses{1-1-3-aff-tor-var, 07-dual-lat-cone}
  % \lean{}
  % \leanok

  $U_\sigma := \Spec \bbC[S_\sigma]$ is an affine toric variety.
\end{definition}


\begin{theorem}[Dimension of the affine toric variety of a rational polyhedral cone]
  \label{08-dim-aff-tor-var-rat-polyhedral-cone}
  \uses{02-salient-cone, 1-2-18-aff-tor-var-rat-polyhedral-cone}
  % \lean{}
  % \leanok

  \[
    \dim U_\sigma = \dim N \iff \text{ the torus of $U_\sigma$ is } T_N = N \ox_[\Z] \bbC^* \iff \sigma \text{ is salient}.
  \]
\end{theorem}
\begin{proof}
  \uses{1-1-14-char-spec-aff-mon-alg, 02-salient-cone-tfae, 1-2-17-gordan-lemma}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}


\begin{proposition}[The irreducible elements of the dual lattice of a cone]
  \label{02-irred-dual-lat}
  \uses{0-irred, 1-2-min-gen, 02-salient-cone, 1-2-17-dual-lat-cone}
  % \lean{}
  % \leanok

  If $\sigma \subseteq N_\R$ is salient of maximal dimension, then the irreducible elements of $S_\sigma$ are precisely the minimal generators of $\sigma^\vee$.
\end{proposition}
\begin{proof}
  \uses{0-irred-subset-gen, 0-irred-gen}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}

\subsection{Polytopes}

\begin{definition}[Convex hull]
  \label{0-convex-hull}
  \uses{}
  \lean{convexHull}
  \leanok
  For a set $S \subseteq N$, the {\bf convex hull of $S$} is
  $$\Conv(S) := \left\{\sum_{u \in S} \lambda_u | \lambda_u \ge 0, \sum_u \lambda_u = 1\right\}$$
\end{definition}

\begin{definition}[Polytope]
  \label{0-polytope}
  \uses{0-convex-hull}
  \lean{IsPolytope}
  \leanok
  A {\bf polytope} is a set that can be written as $\Conv(S)$ for
  some finite set $S$.
\end{definition}

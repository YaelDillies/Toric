We work with a two mutually dual finite-dimensional vector spaces \( N
\) and \( M \) over a linearly ordered field \( \Bbbk \). This means,
we have a bilinear pairing \( \langle \cdot, \cdot \rangle \colon N
\times M \to \Bbbk \) such that the induced maps \( M \to
\Hom(N,\Bbbk) \) and \( N \to \Hom(N,\Bbbk) \) are both bijective
(this is also known as a \emph{perfect pairing}). Since \( \Bbbk \) is
linearly ordered, we can define the non-negative scalars \(\Bbbk_{\geq
0} = \{t \in \Bbbk \mid t \geq 0 \} \subseteq \Bbbk\). This is a
\emph{semifield}, i.e. a commutative semiring, in which every nonzero
element has a multiplicative inverse.

\section{Polyhedral cones}

\begin{definition}
  \label{3-pointed-cone}
  \uses{}
  \lean{PointedCone}
  \leanok
  A {\bf pointed cone} \( \sigma \subseteq N \) is a \( \Bbbk_{\geq 0}
  \)-submodule of \( N \).
\end{definition}

\begin{definition}
  \label{3-cone-span}
  \uses{3-pointed-cone}
  \lean{PointedCone.span}
  \leanok
  For a set \( S \subseteq N \), the {\bf cone generated by \( S \)}
  is the pointed cone
  \[
      \Cone(S) := \Span_{\Bbbk_{\geq 0}}(S) \subseteq N.
  \]
\end{definition}

\begin{definition}
  \label{3-cone-finitely-generated}
  \uses{3-pointed-cone}
  \lean{Submodule.FG}
  \leanok
  A pointed cone \( \sigma \subseteq N \) is called {\bf finitely
  generated}, if \( \sigma = \Cone(S) \) for some finite set \( S
  \subseteq N \).
\end{definition}

\begin{definition}
  \label{3-dual-cone}
  \uses{3-pointed-cone}
  \lean{PointedCone.dual'}
  \leanok
  For a set \( S \subseteq M \), the {\bf dual cone of \( S \)} is
  the pointed cone
  \[
      S^\vee := \{x \in N \mid \forall y \in S, \langle x, y \rangle
      \geq 0 \} \subseteq N.
  \]
\end{definition}

\begin{definition}
  \label{3-polyhedral-cone}
  \uses{3-dual-cone}
  \lean{PointedCone.IsPolyhedral}
  \leanok
  A pointed cone \( \sigma \subseteq N \) is called {\bf polyhedral},
  if \( \sigma = S^\vee \) for some finite set \( S \subseteq M \).
\end{definition}

\begin{proposition}
  \label{3-dual-polyhedral}
  \uses{3-polyhedral-cone, 3-cone-finitely-generated}
  \lean{PointedCone.IsPolyhedral.dual_of_fg}
  \leanok
  If \( \sigma \subset N \) is finitely generated, then \( \sigma^\vee
  \subset M \) is polyhedral.
\end{proposition}
\begin{proof}
  \uses{}
  \leanok
  Let \( \sigma = \Cone(S) \) for \( S \subseteq N \). We need to show
  \( \Cone(S)^\vee = S^\vee \). The inclusion ``\( \subseteq \)'' is
  obvious, as \( S \subseteq \Cone(S) \). The opposite inclusion can
  be shown by induction on the general element of \( \Cone(S) \).
\end{proof}

\begin{proposition}[Double dual]
  \label{3-double-dual-polyhedral-cone}
  \uses{3-polyhedral-cone}
  \lean{PointedCone.IsPolyhedral.dual_dual_flip,
  PointedCone.IsPolyhedral.dual_flip_dual}
  \leanok
  If \( \sigma \subseteq N \) is polyhedral, then \( \sigma^{\vee\vee}
  = \sigma \).
\end{proposition}
\begin{proof}
  \uses{}
  \leanok
  For any set \( S \subseteq N \) it is trivial to show \(
  S^{\vee\vee\vee} = S^{\vee} \). The claim follows since \( \sigma =
  S^{\vee} \) for a finite set \( S \subseteq N \).
\end{proof}

\begin{proposition}
  \label{3-bot-polyhedral}
  \uses{3-polyhedral-cone}
  \lean{PointedCone.IsPolyhedral.bot}
  \leanok
  The zero-space \( \{0\} \subseteq N \) is a polyhedral cone.
\end{proposition}
\begin{proof}
  \uses{}
  \leanok
  If \( S \subseteq M \) is a finite \( \Bbbk \)-basis of \( M \),
  then \( \{0\} = (S \cup -S)^\vee \).
\end{proof}

\begin{proposition}[Fourier-Motkin elimination]
  \label{3-fourier-motzkin}
  \uses{3-polyhedral-cone}
  \lean{PointedCone.dual_auxGenSet}
  \leanok
  If \( \sigma \subseteq N \) is a polyhedral cone and \( w \in N \),
  then \( \sigma + \Cone(\{w\}) \) is polyhedral too.
\end{proposition}
\begin{proof}
  \leanok
  Write \( \sigma = S^{\vee} \) for a finite \( S \subseteq M \).
  Define
  \[
      T\ :=\ \{x \in S \mid 0 \leq \langle x, w \rangle \}\ \cup\ 
      \{y \langle x, w \rangle - x \langle y, w \rangle \mid x, y \in
      S, 0 \leq \langle x, w \rangle, \langle y, w \rangle < 0 \}\ 
      \subseteq\ M.
  \]
  Note that \( T \) is finite. We claim \( S^{\vee} + \Cone(\{w\}) =
  T^{\vee} \). Clearly \( T \subseteq \Cone(S) \), hence \( S^{\vee} =
  \Cone(S)^{\vee} \subseteq T^{\vee} \). Also clear is \( w \in
  T^{\vee} \), hence \( S^{\vee} + \Cone(\{w\}) \subset T^{\vee} \).
  For the reverse inclusion, let \( v \in T^\vee \). We need to show
  \( v - uw \in S^\vee \) for some \( u \in \Bbbk_{\geq 0} \). If
  there is no \( y \in S \) with both \( \langle y, w \rangle < 0 \)
  and \( \langle y, v \rangle < 0 \), we can easily see that \( u = 0
  \) works, i.e. \( T^{\vee} \subseteq S^{\vee} \). Otherwise, we
  set
  \[
      u\ :=\ \max_{\substack{y \in S \\ \langle y, w \rangle < 0}}
      \frac{\langle y, v \rangle}{\langle y, w \rangle},
  \]
  which is then well-defined and non-negative. We need to show
  \( u \langle z, w \rangle \leq \langle z, v \rangle \) for all \( z
  \in S \). If \( \langle z, w \rangle < 0 \), this follows from
  maximality of \( u \). If \( \langle z, w \rangle = 0 \), the claim
  follows from \( z \in T \) and \( v \in T^{\vee} \). Lastly, assume
  \( \langle z, w \rangle > 0 \) and fix \( y \in S \) such that \( u
  = \frac{\langle y, v \rangle}{\langle y, w \rangle} \). In
  particular, \( \langle y, w \rangle < 0 \). Then the claim \( u
  \langle z, w \rangle \leq \langle z, v \rangle \) is equivalent to
  \[
      \langle y, v \rangle \langle z, w \rangle \geq
      \langle z, v \rangle \langle y, w \rangle.
  \]
  But \( y \langle z, w \rangle - z \langle y, w \rangle \in T \),
  hence the claim follows from \( v \in T^{\vee} \).
\end{proof}

\begin{proposition}
  \label{3-polyhedral-of-fg}
  \uses{PointedCone.IsPolyhedral.of_fg}
  \lean{}
  \leanok
  If \( \sigma \in N \) is finitely generated, then it is polyhedral.
\end{proposition}
\begin{proof}
  \uses{3-bot-polyhedral, 3-fourier-motzkin}
  \leanok
  Write \( \sigma = \Cone(S) \) and use induction on the size of \( S
  \): For \( S = \emptyset \), we use~\ref{3-bot-polyhedral}
  and the induction step is~\ref{3-fourier-motzkin}.
\end{proof}

\begin{proposition}
  \label{3-double-dual-finite-set}
  \uses{}
  \lean{PointedCone.dual_dual_eq_span}
  \leanok
  For a finite set \( S \subseteq N \), we have \( S^{\vee\vee} =
  \Cone(S) \).
\end{proposition}
\begin{proof}
  \uses{3-polyhedral-of-fg, 1-2-1-double-dual-polyhedral-cone}
  \leanok
  The cone \( \sigma := \Cone(S) \) is finitely generated, hence
  polyhedral by~\ref{3-polyhedral-of-fg}. Furthermore, we have \(
  \sigma^{\vee\vee} = S^{\vee\vee} \). Now
  apply~\ref{3-double-dual-polyhedral-cone}.
\end{proof}

\begin{proposition}[Polyhedral = Finitely generated]
  \label{3-polyhedral-iff-fg}
  \uses{}
  \lean{PointedCone.IsPolyhedral_iff_fg}
  \leanok
  A pointed cone \( \sigma \subseteq N \) is finitely generated iff it is
  polyhedral.
\end{proposition}
\begin{proof}
  \uses{3-polyhedral-of-fg}
  \leanok
  The implication ``\( \Rightarrow \)'' is
  Proposition~\ref{3-polyhedral-of-fg}. For the converse, assume
  \( \sigma = S^{\vee} \) for some finite \( S \subseteq M \). Then \(
  \Cone(S) \) is finitely generated, hence polyhedral
  by~\ref{3-polyhedral-of-fg}. Thus we find a finite \( T
  \subseteq N \) with \( \Cone(S) = T^\vee \). We obtain
  \[
      \sigma = S^{\vee} = \Cone(S)^\vee = T^{\vee\vee} = \Cone(T),
  \]
  where the last equality is due
  to~\ref{3-double-dual-finite-set}. Thus \( \sigma \) is finitely
  generated.
\end{proof}

\begin{proposition}
  \label{3-dual-polyhedral-cone}
  \uses{3-polyhedral-cone}
  \lean{PointedCone.IsPolyhedral.dual}
  \leanok
  If \( \sigma \subseteq N \) is
  polyhedral, then \( \sigma^\vee \subseteq M \) is polyhedral too.
\end{proposition}
\begin{proof}
  \uses{3-dual-polyhedral, 3-polyhedral-iff-fg}
  \leanok
  \ref{3-dual-polyhedral} \( + \) \ref{3-polyhedral-iff-fg}.
\end{proof}


\subsection{Faces and the relative interior}

We define faces of polyhedral cones. The main goal is the partial
order relation on the set of faces and showing that there is a
bijection between faces of \( \sigma \) and faces of \( \sigma^{\vee}
\). On the way, we also define relative interiors.

\begin{definition}
  \label{3-perp}
  \uses{}
  % \lean{}
  % \leanok
  For any subset \( A \subseteq M \), we define the \emph{perp space}
  \[
      A^{\perp}\ :=\ \{v \in N\ \mid\ \forall u \in A, \langle v, u \rangle = 0\},
  \]
  which is a pointed cone in \( N \). We also write \( u^{\perp} :=
  \{u\}^{\perp} \).
\end{definition}

\begin{lemma}
  \label{3-perp-closed-negation}
  \uses{}
  % \lean{}
  % \leanok
  If \( A \subseteq M \) is closed under negation (for instance, \( A
  \subseteq M \) a \( \Bbbk \)-submodule), then \( A^{\perp} =
  A^{\vee} \).
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok
  \( A^{\perp} \subseteq A^{\vee} \) is clear. Let \( x \in A^{\vee}
  \) and \( a \in A \). then \( \langle x, a \rangle \geq 0 \) and \(
  -\langle x, a \rangle = \langle x, -a \rangle \geq 0 \). Hence \(
  \langle x, a \rangle = 0 \) and \( x \in A^{\perp} \).
\end{proof}


\begin{definition}[Face of a cone]
  \label{3-face}
  \uses{3-perp}
  % \lean{}
  % \leanok
  A \emph{face} of a pointed cone \( \sigma \subseteq N \) is the
  intersection of \( \sigma \) with some hyperplane \( u^{\perp} \)
  for \( u \in \sigma^{\vee} \). We write \( \tau \preceq \sigma \) if
  \( \tau \) is a face of \( \sigma \) and \( \tau \prec \sigma \) if
  \( \tau \) is a \emph{proper} face, i.e. \( \tau \preceq \sigma \)
  and \( \tau \neq \sigma \).
\end{definition}

\begin{proposition}
  \label{3-face-polyhedral}
  \uses{3-face, 3-polyhedral-cone}
  % \lean{}
  % \leanok
  Let \( \sigma = \Cone(S) \) be a polyhedral cone with \( S \subseteq
  N \) finite. Then for \( u \in \sigma^{\vee} \), we have
  \[
      \sigma \cap u^{\perp} = \Cone(S \cap u^{\perp}).
  \]
  In particular, since \( S \cap u^{\perp} \) is also finite, a face
  of a polyhedral cone is polyhedral.
\end{proposition}
\begin{proof}
    Let \( \sigma = S^{\vee} \) be polyhedral, where \( S \subseteq M
    \) finite and consider a face \( \tau = \sigma \cap u^{\perp} \)
    for \( u \in \sigma^{\vee} \). We claim that \( \tau = (S \cup
    \{-u\})^\vee \). The inclusion ``\( \subseteq \)'' is obvious. For
    the converse, suppose \( v \in (S \cup \{-u\})\vee = \sigma \cap
    \{-u\}^\vee \). Then \( \langle v, u \rangle \leq 0 \). But since
    \( u \in \sigma^{\vee} \), we also have \( \langle v, u \rangle
    \geq 0 \). We obtain \( \langle v, u \rangle = 0 \), which shows
    the claim.
\end{proof}

\begin{lemma}
  \label{3-faces-polyhedral-cone-finite}
  \uses{3-face-polyhedral}
  % \lean{}
  % \leanok
  A polyhedral cone has only finitely many faces.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok
  By \ref{3-face-polyhedral}, a face of a polyhedral cone \( \sigma =
  \Cone(S) \) is of the form \( \Cone(S') \) for some \( S' \subseteq
  S \). Being finite, \( S \) has only finitely many subsets, which
  shows the claim.
\end{proof}


\begin{lemma}[Intersection of faces]
  \label{3-face-intersection}
  \uses{3-face}
  % \lean{}
  % \leanok
  If \( \sigma \) is a pointed cone, then the intersection of two
  faces of \( \sigma \) is a again face of \( \sigma \).
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok
  Let \( \tau = \sigma \cap u^{\perp} \) and \( \tau' = \sigma \cap
  \tau'^{\perp} \) be faces. We claim that \( \sigma \cap u^{\perp}
  \cap u'^{\perp} = \sigma \cap (u + u')^{\perp} \). The inclusion
  ``\( \subseteq \)'' is obvious. For the converse, suppose \( v \in
  \sigma \) with \( \langle v, u \rangle + \langle v, u' \rangle = 0
  \). Since \( u, u' \in \sigma^{\vee} \), both summands are
  nonnegative, hence \( \langle v, u \rangle = \langle v, u' \rangle =
  0 \).
\end{proof}

\begin{lemma}
  \label{3-face-dual-eq-sum}
  \uses{3-face}
  % \lean{}
  % \leanok
  Let \( \tau \preceq \sigma \) be a face of a pointed cone. Then \(
  \tau^{\vee} = \tau^{\perp} + \sigma^{\vee} \).
\end{lemma}
\begin{proof}
  \uses{3-perp-closed-negation}
  % \leanok
  It's easy to show that \( \tau = \Span_{\Bbbk}(\tau) \cap
  \sigma^{\vee} \). Dualising gives \( \tau^{\vee} =
  \Span_{\Bbbk}(\tau)^{\vee} + \sigma^{\vee} \).
  Apply~\ref{3-perp-closed-negation} to get \(
  \Span_{\Bbbk}(\tau)^{\vee} = \Span_{\Bbbk}(\tau)^{\perp} =
  \tau^{\perp} \).
\end{proof}



\begin{lemma}[Face of a face]
  \label{3-face-face}
  \uses{3-face}
  % \lean{}
  % \leanok
  A face of a face of a polyhedral cone \( \sigma \) is again a face
  of \( \sigma \).
\end{lemma}
\begin{proof}
  \uses{3-face-dual-eq-sum}
  % \leanok
  Let \( \tau = \sigma \cap u^{\perp} \) with \( u \in \sigma^{\vee}
  \) and \( \rho = \tau \cap v^{\perp} \) with \( v \in \tau^{\vee}
  \). By \ref{3-face-dual-eq-sum}, we can write \( v = v_1 + v_2 \)
  with \( v_1 \in \tau^{\perp} \) and \( v_2 \in \sigma^{\vee} \).
  Then \( u + v_2 \in \sigma^{\vee} \) and we claim \( \rho = \sigma
  \cap (u + v_2)^{\perp} \). For ``\( \subseteq \)'', let \( x \in
  \rho = \tau \cap v^{\perp} \). Since \( x \in \tau \), we get \(
  \langle x, u \rangle = 0 \) and \( \langle x, v_1 \rangle = 0 \).
  Since \( x \in v^{\perp} \), also \( \langle x, v \rangle = 0 \),
  which by \( v = v_1 + v_2 \) implies \( \langle x, v_2 \rangle = 0
  \). In total, \( \langle x, u + v_2 \rangle = 0 \). For the
  converse, assume \( x \in \sigma \cap (u + v_2)^{\perp} \), i.e. \(
  \langle x, u \rangle + \langle x, v_2 \rangle = 0 \). Since both \(
  u, v_2 \in \sigma^{\vee} \) and \( x \in \sigma \), both summands
  are nonnegative, hence \( \langle x, u \rangle = \langle x, v_2
  \rangle = 0 \). This implies \( x \in \tau \), thus also \( \langle
  x, v_1 \rangle = 0 \). In total, \( \langle x, v \rangle = \langle
  x, v_1 \rangle + \langle x, v_2 \rangle = 0 \), thus \( x \in \rho
  \).
\end{proof}

In particular, Lemma~\ref{3-face-face} establishes a partial order on
the set of faces of a polyhedral cone \( \sigma \), which is finite
by~\ref{3-faces-polyhedral-cone-finite}. Next, we need the notion of
relative interior, which we define here completely algebraically. When
working over \( \R \), it is the same as the topological interior of
\( \sigma \) in its span.

\begin{definition}[Relative interior]
  \label{3-rel-interior}
  \uses{3-dual-cone, 3-perp}
  % \lean{}
  % \leanok
  The \emph{relative interior} of a pointed cone \( \sigma \subseteq N
  \) (written \( \sigma^{\circ} \)) is the subset of all \( v \in
  \sigma \) such that \( \langle v, u \rangle > 0 \) for all \( u \in
  \sigma^{\vee} \backslash \sigma^{\perp} \). Note that \(
  \sigma^{\circ} \) is not a pointed cone (it does not contain \( 0
  \)), but it is closed under addition and \( \Bbbk_{\geq 0} \)-scalar
  multiplication.
\end{definition}

\begin{lemma}
  \label{3-rel-interior-perp}
  \uses{}
  % \lean{}
  % \leanok
  For a pointed cone \( \sigma \), we have \( v \in \sigma^{\circ} \)
  if and only if \( \sigma^{\perp} = \sigma^{\vee} \cap v^{\perp} \).
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok
  Easy, just reformulating the definition.
\end{proof}

\begin{lemma}
  \label{3-rel-interior-positive-lincomb}
  \uses{3-rel-interior}
  % \lean{}
  % \leanok
  Let \( \sigma = \Cone(S) \) be a polyhedral cone with \( S = \{v_1,
  \dots, v_n\} \). Then \( v \in \sigma^{\perp} \) iff \( v =
  \sum_{i=1}^n \lambda_i v_i \) for positive scalars \( \lambda_i > 0
  \).
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok
  One direction is easy: Suppose \( v = \sum_{i=1}^n \lambda_i v_i \)
  for \( \lambda_i > 0 \). We claim \( v \in \sigma^{\circ} \). Let \(
  u \in \sigma^{\vee} \backslash \sigma^{\perp} \) be arbitrary. Since
  \( u \notin \sigma^{\perp} \), there exists an \( i \) with \(
  \langle v_i, u \rangle > 0 \). This implies
  \[
      \langle v, u \rangle = \sum_{i=1}^n \lambda_i \langle v_i, u
      \rangle > 0.
  \]
  The other direction is a bit more involved, TODO.
\end{proof}

\begin{lemma}
  \label{3-rel-interior-nonempty}
  \uses{}
  % \lean{}
  % \leanok
  The relative interior of a polyhedral cone is nonempty.
\end{lemma}
\begin{proof}
  \uses{3-rel-interior-positive-lincomb}
  % \leanok
  Follows directly from~\ref{3-rel-interior-positive-lincomb}
\end{proof}

\begin{definition}[Dual face]
  \label{3-dual-face}
  \uses{3-dual-cone, 3-face}
  % \lean{}
  % \leanok
  Given a cone \( \sigma \) and a face \( \tau \preceq \sigma \), the
  \emph{dual face} to \( \tau \) is
  \[
      \tau^* := \sigma^{\vee} \cap \tau^{\perp}.
  \]
\end{definition}

The dual face is actually a face:

\begin{proposition}
  \label{3-dual-face-face-dual}
  \uses{3-dual-face, 3-rel-interior-nonempty}
  % \lean{}
  % \leanok
  If \( \tau \preceq \sigma \), then \( \tau^* \preceq \sigma^\vee \).
\end{proposition}
\begin{proof}
  \uses{3-rel-interior-nonempty, 3-double-dual-polyhedral-cone,
  3-rel-interior-perp}
  % \leanok
  Let \( \tau = \sigma \cap u^{\perp} \) for \( u \in \sigma^{\vee}
  \). We need to find a \( v \in \sigma^{\vee\vee} = \sigma \) such
  that \( \tau^* = \sigma \cap v^{\perp} \).
  By~\ref{3-rel-interior-nonempty}, we may pick \( v \in
  \sigma^{\circ} \), which works by~\ref{3-rel-interior-perp}.
\end{proof}


\begin{proposition}
  \label{3-double-dual-face-dual-face}
  \uses{3-dual-face}
  % \lean{}
  % \leanok
  If $\tau \preceq \sigma$, then $\tau^{**} = \tau$.
\end{proposition}
\begin{proof}
  \uses{1-2-4-double-dual-polyhedral-cone}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[The dual of a face is antitone]
  \label{3-dual-face-antitone}
  \uses{3-dual-face}
  % \lean{}
  % \leanok

  If $\tau' \preceq \tau \preceq \sigma$, then $\tau' \preceq \tau$.
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{proposition}[The dimension of the dual of a face]
  \label{3-dim-dual-face}
  \uses{3-dual-face}
  % \lean{}
  % \leanok

  If $\tau \preceq \sigma$, then
  $$\dim \tau + \dim \tau^* = \dim N.$$
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}



\subsection{Strong Convexity}


\begin{definition}[Salient cones]
  \label{02-salient-cone}
  \uses{}
  \lean{ConvexCone.Salient}
  \leanok

  A cone $\sigma$ is {\bf salient}, aka {\bf pointed} or {\bf strongly convex}, if $\sigma \cap (-\sigma) = \{0\}$.
\end{definition}


\begin{proposition}[Alternative definitions of salient cones]
  \label{02-salient-cone-tfae}
  \uses{3-dual-cone, 02-salient-cone}
  % \lean{}
  % \leanok

  The following are equivalent
  \begin{enumerate}
    \item $\sigma$ is salient
    \item $\{0\} \preceq \sigma$
    \item $\sigma$ contains no positive dimensional subspace
    \item $\dim \sigma^\vee = \dim N$
  \end{enumerate}
\end{proposition}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\subsection{Separation}


\begin{lemma}[Separation lemma]
  \label{03-separation-lemma}
  \uses{3-polyhedral-cone, 1-2-5-face}
  % \lean{}
  % \leanok

  Let $\sigma_1, \sigma_2$ be polyhedral cones meeting along a common face $\tau$. Then
  $$\tau = H_m \cap \sigma_1 = H_m \cap \sigma_2$$
  for any $m \in \Relint(\sigma_1^\vee \cap (-\sigma_2)^\vee)$.
\end{lemma}
\begin{proof}
  \uses{1-2-dual-cone-add, 1-2-min-face}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}


\subsection{Rational Polyhedral Cones}


Let $M$ and $N$ be dual lattices with associated vector spaces $M_\R := M \ox_\Z \R, N_\R := N \ox_\Z \R$.


\begin{definition}[Rational cone]
  \label{04-rat-cone}
  \uses{1-2-cone-span}
  % \lean{}
  % \leanok

  A cone $\sigma \subseteq N_\R$ is {\bf rational} if $\sigma = \Cone(S)$ for some finite set $S \subseteq N$.
\end{definition}


\begin{lemma}[Faces of a rational cone]
  \label{04-face-rat-cone}
  \uses{1-2-5-face, 04-rat-cone}
  % \lean{}
  % \leanok

  If $\tau \preceq \sigma$ is a face of a rational cone, then $\tau$ itself is rational.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{lemma}[The dual of a rational cone]
  \label{04-dual-rat-cone}
  \uses{3-dual-cone, 04-rat-cone}
  % \lean{}
  % \leanok

  $\sigma^\vee$ is a rational cone iff $\sigma$ is.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{definition}[Ray generator]
  \label{1-2-ray-gen}
  \uses{1-2-5-edge, 04-rat-cone}
  % \lean{}
  % \leanok

  If $\rho$ is an edge of a rational cone $\sigma$, then the monoid $\rho \cap N$ is generated by a unique element $u_\rho \in \rho \cap N$, which we call the {\bf ray generator} of $\rho$.
\end{definition}


\begin{definition}[Minimal generators]
  \label{1-2-min-gen}
  \uses{1-2-ray-gen}
  % \lean{}
  % \leanok

  The {\bf minimal generators} of a rational cone $\sigma$ are the ray generators of its edges.
\end{definition}


\begin{lemma}[A rational cone is generated by its minimal generators]
  \label{05-cone-hull-min-gen}
  \uses{02-salient-cone, 1-2-min-gen}
  % \lean{}
  % \leanok

  A salient convex rational polyhedral cone is generated by its minimal generators.
\end{lemma}
\begin{proof}
  \uses{}
  % \leanok

  Classic. See \cite{Oda_1988} maybe.
\end{proof}


\begin{definition}[Regular cone]
  \label{06-reg-cone}
  \uses{1-2-min-gen}
  % \lean{}
  % \leanok

  A salient rational polyhedral cone $\sigma$ is {\bf regular}, aka {\bf smooth}, if its minimal generators form part of a $\Z$-basis of $N$.
\end{definition}


\begin{definition}[Simplicial cone]
  \label{06-simplicial-cone}
  \uses{1-2-min-gen}
  % \lean{}
  % \leanok

  A salient rational polyhedral cone $\sigma$ is {\bf simplicial} if its minimal generators are $\R$-linearly independent.
\end{definition}


\subsection{Semigroup Algebras and Affine Toric Varieties}


\begin{definition}[Dual lattice of a cone]
  \label{07-dual-lat-cone}
  \uses{3-dual-cone}
  % \lean{}
  % \leanok

  If $\sigma \subseteq N_\R$ is a polyhedral cone, then the lattice points
  \[
    S_\sigma := \sigma^\vee \cap M
  \]
  form a monoid.
\end{definition}


\begin{proposition}[Gordan's lemma]
  \label{07-gordan-lemma}
  \uses{07-dual-lat-cone}
  % \lean{}
  % \leanok

  $S_\sigma$ is finitely generated as a monoid.
\end{proposition}
\begin{proof}
  \uses{04-dual-rat-cone}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}


\begin{definition}[Affine toric variety of a rational polyhedral cone]
  \label{08-aff-tor-var-rat-polyhedral-cone}
  \uses{1-1-3-aff-tor-var, 07-dual-lat-cone}
  % \lean{}
  % \leanok

  $U_\sigma := \Spec \bbC[S_\sigma]$ is an affine toric variety.
\end{definition}


\begin{theorem}[Dimension of the affine toric variety of a rational polyhedral cone]
  \label{08-dim-aff-tor-var-rat-polyhedral-cone}
  \uses{02-salient-cone, 1-2-18-aff-tor-var-rat-polyhedral-cone}
  % \lean{}
  % \leanok

  \[
    \dim U_\sigma = \dim N \iff \text{ the torus of $U_\sigma$ is } T_N = N \ox_[\Z] \bbC^* \iff \sigma \text{ is salient}.
  \]
\end{theorem}
\begin{proof}
  \uses{1-1-14-char-spec-aff-mon-alg, 02-salient-cone-tfae, 1-2-17-gordan-lemma}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}


\begin{proposition}[The irreducible elements of the dual lattice of a cone]
  \label{02-irred-dual-lat}
  \uses{3-irred, 1-2-min-gen, 02-salient-cone, 1-2-17-dual-lat-cone}
  % \lean{}
  % \leanok

  If $\sigma \subseteq N_\R$ is salient of maximal dimension, then the irreducible elements of $S_\sigma$ are precisely the minimal generators of $\sigma^\vee$.
\end{proposition}
\begin{proof}
  \uses{3-irred-subset-gen, 3-irred-gen}
  % \leanok

  See \cite{Cox_2011}.
\end{proof}

\subsection{Polytopes}

\begin{definition}[Convex hull]
  \label{3-convex-hull}
  \uses{}
  \lean{convexHull}
  \leanok
  For a set $S \subseteq N$, the {\bf convex hull of $S$} is
  $$\Conv(S) := \left\{\sum_{u \in S} \lambda_u | \lambda_u \ge 0, \sum_u \lambda_u = 1\right\}$$
\end{definition}

\begin{definition}[Polytope]
  \label{3-polytope}
  \uses{3-convex-hull}
  \lean{IsPolytope}
  \leanok
  A {\bf polytope} is a set that can be written as $\Conv(S)$ for
  some finite set $S$.
\end{definition}
